环境：linux gcc

# 编译

## gcc

### 常规

```
gcc hello.c -o hello
```

这会编译hello.c生成一个名为hello的可执行文件

### 常见选项

- **`-o`**：指定输出文件的名称。
- **`-Wall`**：启用所有常见的警告。
- **`-g`**：生成调试信息，可以与调试器（如 `gdb`）配合使用。
- **`-O`**：进行优化编译，`-O2` 或 `-O3` 为更高级别优化。

## 文件后缀种类

| *.a         | 静态库文件                             |
| ----------- | -------------------------------------- |
| *.c         | c语言程序源文件                        |
| *.h         | c语言头文件                            |
| *.i         | 预处理完的源文件                       |
| *.o         | 可重定位的目标文件（一般称为目标文件） |
| *.s         | 汇编语言文件                           |
| *.so        | 动态链接库文件                         |
| *（无后缀） | 可执行文件                             |

注：这是指的linux的文件命名规范，win可能有些不同，如.dll是动态链接库文件，.exe是可执行文件等

## 编译过程

| hello.c | ->              | hello.i          | ->            | hello.s | ->           | hello.o                      | ->           | hello          |
| ------- | :-------------- | ---------------- | ------------- | ------- | ------------ | ---------------------------- | ------------ | -------------- |
| 源程序  | 预处理器（cpp） | 预处理完毕的程序 | 编译器（ccl） | 汇编    | 汇编器（as） | 可重定位目标程序（目标文件） | 链接器（ld） | 可执行目标程序 |
| 文本    |                 | 文本             |               | 文本    |              | 二进制                       |              | 二进制         |
|         |                 |                  |               |         |              |                              |              |                |



### 预处理

```
gcc -E hello.c -o hello.i
```

所以`-E`是c文件转换到预处理完的源文件的命令参数

**如果不加`-o hello.i`默认不会生成输出文件，只会在终端输出文本**

### 编译

```
gcc -S hello.c -o hello.s
```

所以`-S`是将.c文件转换到汇编文件的命令参数

### 汇编

```
gcc -c hello.c -o hello.o
```

所以`-c`是将.c文件转换到目标文件的命令参数

### 链接（编译完毕）

```
gcc <所有.c文件/所有.o文件> -o hello
```

一般没有参数

### 工作流如何应用

在预处理、编译、汇编的过程中通常都是一个文件输入对应一个文件的输出，而链接是多个.o的输入对应一个可执行文件的输出。

-E、-S一般只会用作调试环节的差错，正常顺序执行一般用不到

而且一般我们编写makefile告诉gcc要执行的一般也只有生成目标文件（-c）和可执行文件(无参)两步。

要生成目标文件，是因为当我们修改少部分源码的时候，可以在生成目标文件的时候，只重新生成改过的源码对应的目标文件，这样可以以更快的速度重新构建整个工程